package redshield.demo

test_admin_can_list_content_routes_for_tenant {
    allow with input as {
        "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjBMdDByckZ3WEx5UHliVjQtNUQ3NiJ9.eyJpc3MiOiJodHRwczovL2p2LWRlbW8uYXUuYXV0aDAuY29tLyIsInN1YiI6ImF1dGgwfDVjYzhlNDMzNjg0NzgxMGU3NTFhYThjZSIsImF1ZCI6Imh0dHBzOi8vZGVtby1kdW1teS1hcGkuanYtZGVtby5jb20iLCJpYXQiOjE2MDc1NzY3OTcsImV4cCI6MTYwNzY2MzE5NywiYXpwIjoieUQzME5VTmtaU3FjQXA3Z2k4YncyR1ByZ2xjdDA4R0oiLCJzY29wZSI6InJlYWQ6ZGVtbyB3cml0ZTpkZW1vIGp1bms6anVuayBhdXRoOmNvbmZsdWVuY2UtdXNlciBvZmZsaW5lX2FjY2VzcyIsImd0eSI6InBhc3N3b3JkIn0.kkvD7NjkMIVfmHMbjwdYDKClFpmlnF8L_x12VzR7gnzY8C9WjIW4ryx5cCR-ofzUhxfgi7rav2tB2fGqN6P4Tasn27YNtFM0QxU3PYzDRx6OUfWOz9qFSPlYedMRrbpsO_J0VZhdQlqGNtx_PWiwRMZIXxudYisBfgKh_jlxt5boptn8nfTVAua-DYpIB_2TfVKDgkSMEQrubMo_S-SlIavB7rok7rpBJOYKYyHBiN-XYaKooweAfkadg-I6lABRyFV7qIQZxmhv9odOK1s3I97O3kBwDsH6gGzttfJqlgD8Q7kUEUxGYpVXDIPlLGZGYB6BpVRFwtgoFbwJIRNM0w",
        "action": "list",
        "resource": "content_route",
        "tenant": "cocacola"
    }
}

test_user_canNOT_list_content_routes_for_tenant {
    not allow with input as {
        "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjBMdDByckZ3WEx5UHliVjQtNUQ3NiJ9.eyJpc3MiOiJodHRwczovL2p2LWRlbW8uYXUuYXV0aDAuY29tLyIsInN1YiI6ImF1dGgwfDVlNzE2ZDcxNDhkZTlmMGNhMTI1NzI1MiIsImF1ZCI6Imh0dHBzOi8vZGVtby1kdW1teS1hcGkuanYtZGVtby5jb20iLCJpYXQiOjE2MDc1NzY5NTQsImV4cCI6MTYwNzY2MzM1NCwiYXpwIjoieUQzME5VTmtaU3FjQXA3Z2k4YncyR1ByZ2xjdDA4R0oiLCJzY29wZSI6InJlYWQ6ZGVtbyB3cml0ZTpkZW1vIGp1bms6anVuayBhdXRoOmNvbmZsdWVuY2UtdXNlciBvZmZsaW5lX2FjY2VzcyIsImd0eSI6InBhc3N3b3JkIn0.XhSFDPAWvA7-GT405P62UPzU3ZJNK_RyNRKfVsKmjX37lA-dLvEoZlywcAeEdpgmRR_n9-ggpILjUhOFww7TP3ph4bZOupvD7OfVdIBWJo3-S8PnUpnEWZ1QepVppTFHjzKg_X7cedLPFc5LRO86IQY6yNX2pnrT3h25WIRGrDeLPRZYnyYabMzsTtVLtsYVF0MoFycFqsZUYq3EtSOiPjVWCnB5RWhhYnOZYAEwH99c_bhUoxxjklpm_kpHQI8jhpLCpFdWyz1wH8Af1YpmdU8NLZoG7kqrnypHFIaixaikLn7DEHVP4IL8vATPjnRVO43gaTH9dr7WC3uICDhETA",
        "action": "list",
        "resource": "content_route",
        "tenant": "chevrolet"
    }
}

test_user_can_validate_token_for_tenant {
    allow with input as {
        "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjBMdDByckZ3WEx5UHliVjQtNUQ3NiJ9.eyJpc3MiOiJodHRwczovL2p2LWRlbW8uYXUuYXV0aDAuY29tLyIsInN1YiI6ImF1dGgwfDVlNzE2ZDcxNDhkZTlmMGNhMTI1NzI1MiIsImF1ZCI6Imh0dHBzOi8vZGVtby1kdW1teS1hcGkuanYtZGVtby5jb20iLCJpYXQiOjE2MDc1NzY5NTQsImV4cCI6MTYwNzY2MzM1NCwiYXpwIjoieUQzME5VTmtaU3FjQXA3Z2k4YncyR1ByZ2xjdDA4R0oiLCJzY29wZSI6InJlYWQ6ZGVtbyB3cml0ZTpkZW1vIGp1bms6anVuayBhdXRoOmNvbmZsdWVuY2UtdXNlciBvZmZsaW5lX2FjY2VzcyIsImd0eSI6InBhc3N3b3JkIn0.XhSFDPAWvA7-GT405P62UPzU3ZJNK_RyNRKfVsKmjX37lA-dLvEoZlywcAeEdpgmRR_n9-ggpILjUhOFww7TP3ph4bZOupvD7OfVdIBWJo3-S8PnUpnEWZ1QepVppTFHjzKg_X7cedLPFc5LRO86IQY6yNX2pnrT3h25WIRGrDeLPRZYnyYabMzsTtVLtsYVF0MoFycFqsZUYq3EtSOiPjVWCnB5RWhhYnOZYAEwH99c_bhUoxxjklpm_kpHQI8jhpLCpFdWyz1wH8Af1YpmdU8NLZoG7kqrnypHFIaixaikLn7DEHVP4IL8vATPjnRVO43gaTH9dr7WC3uICDhETA",
        "action": "validate",
        "resource": "token",
        "tenant": "chevrolet"
    }
}

test_poweruser_can_upload_token_for_tenant {
    allow with input as {
        "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjBMdDByckZ3WEx5UHliVjQtNUQ3NiJ9.eyJpc3MiOiJodHRwczovL2p2LWRlbW8uYXUuYXV0aDAuY29tLyIsInN1YiI6ImF1dGgwfDVjYzhlNDMzNjg0NzgxMGU3NTFhYThjZSIsImF1ZCI6Imh0dHBzOi8vZGVtby1kdW1teS1hcGkuanYtZGVtby5jb20iLCJpYXQiOjE2MDc1NzY3OTcsImV4cCI6MTYwNzY2MzE5NywiYXpwIjoieUQzME5VTmtaU3FjQXA3Z2k4YncyR1ByZ2xjdDA4R0oiLCJzY29wZSI6InJlYWQ6ZGVtbyB3cml0ZTpkZW1vIGp1bms6anVuayBhdXRoOmNvbmZsdWVuY2UtdXNlciBvZmZsaW5lX2FjY2VzcyIsImd0eSI6InBhc3N3b3JkIn0.kkvD7NjkMIVfmHMbjwdYDKClFpmlnF8L_x12VzR7gnzY8C9WjIW4ryx5cCR-ofzUhxfgi7rav2tB2fGqN6P4Tasn27YNtFM0QxU3PYzDRx6OUfWOz9qFSPlYedMRrbpsO_J0VZhdQlqGNtx_PWiwRMZIXxudYisBfgKh_jlxt5boptn8nfTVAua-DYpIB_2TfVKDgkSMEQrubMo_S-SlIavB7rok7rpBJOYKYyHBiN-XYaKooweAfkadg-I6lABRyFV7qIQZxmhv9odOK1s3I97O3kBwDsH6gGzttfJqlgD8Q7kUEUxGYpVXDIPlLGZGYB6BpVRFwtgoFbwJIRNM0w",
        "action": "upload",
        "resource": "token",
        "tenant": "abercrombie"
    }
}
